# コード設計 - Auth 領域

`auth` ディレクトリ以下では、Firebase Authentication を使用したユーザー認証機能を実装する。

## 主要コンポーネント

### auth.tsx

認証領域のメインコンポーネント。

- **機能**:
  - 認証状態チェック（既ログイン時は `/app` にリダイレクト）
  - ルーティング管理（login, registar, reset）
  - 共通レイアウト（背景画像 + ブラーカード）
  - ホームページへの戻るリンク
- **スタイル**: `FillBackgroundDesign` + `BlurCard` による美しい UI

### 共通コンポーネント

#### formGroup.tsx

Bootstrap フォームをラップした共通コンポーネント。

- **目的**: フォーム項目の統一的なスタイリング
- **Props**:
  - `controlId`: フォームコントロール ID
  - `label`: ラベルテキスト
  - `children`: フォーム要素（input, select 等）

#### moveCard.tsx

認証画面間の移動を促すカードコンポーネント。

- **機能**:
  - 現在の URL を検知し、他の認証画面へのリンクを表示
  - 画面右下に固定配置
  - FontAwesome アイコン付きのリンクカード

## 認証機能別コンポーネント

### Signin/signin.tsx

ログイン機能コンポーネント。

- **機能**:
  - メールアドレス・パスワード入力
  - Firebase Authentication でログイン処理
  - エラーハンドリング
- **実装**: `login.ts` を使用した認証処理

### Registar/registar.tsx

新規登録機能コンポーネント。

- **機能**:
  - メールアドレス・パスワード・確認パスワード入力
  - 利用規約同意チェック
  - パスワード一致検証
  - Firebase Authentication でアカウント作成
  - メールアドレス認証メール送信
- **実装**: `createUser.ts` を使用した新規ユーザー作成

### Reset/reset.tsx

パスワードリセット機能コンポーネント。

- **機能**:
  - メールアドレス入力
  - Firebase でパスワードリセットメール送信
- **実装**: `reset.ts` を使用したリセット処理

## 認証状態管理

### AuthContext (common/firebase/authContext.tsx)

認証状態とユーザーデータの統合管理。

- **提供情報**:
  - Firebase Auth User オブジェクト
  - Firestore からのユーザーデータ
- **機能**:
  - 認証状態の監視
  - ユーザーデータの自動取得
  - ローディング状態管理

## Firebase 連携

### 使用する認証機能

- **メールアドレス/パスワード認証**: 基本的な認証方式
- **メールアドレス認証**: アカウント作成後の確認メール
- **パスワードリセット**: 忘れた場合のリセット機能

### セキュリティ考慮

- **クライアントサイド検証**: パスワード一致確認、必須項目チェック
- **Firebase 側検証**: サーバーサイドでの検証とエラーレスポンス
- **XSS 対策**: React のデフォルト保護機能を活用

## UI/UX 設計

### 共通デザイン要素

- **背景**: 統一された背景画像（`/assets/auth/bg.webp`）
- **カード**: ブラー効果のある半透明カード
- **アニメーション**: 滑らかな画面遷移
- **レスポンシブ**: モバイル・タブレット・デスクトップ対応

### ユーザビリティ

- **画面間遷移**: 右下の移動カードで直感的な操作
- **フィードバック**: 処理成功・エラー時のアラート表示
- **アクセシビリティ**: 適切なラベルとフォーカス管理

## エラーハンドリング

- **ネットワークエラー**: Firebase 接続エラーの適切な表示
- **バリデーションエラー**: リアルタイムでの入力検証
- **認証エラー**: Firebase から返されるエラーの分かりやすい表示

## 実装パターン

```typescript
// 基本的な認証処理パターン
const handleSubmit = async (event: FormEvent) => {
  event.preventDefault();
  try {
    await authFunction(email, password);
    // 成功時の処理
  } catch (error) {
    // エラーハンドリング
    console.error(error);
  }
};
```
